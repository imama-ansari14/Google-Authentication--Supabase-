<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Post Application</title>
    <!-- Bootstrap CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    <!--Bootstrap ICON  -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
</head>
<body class="bg-light">
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-md-8 col-lg-6">
                <h3 class="text-center mb-4 fw-bold">Post Here</h3>
                <div class="card shadow-sm">
                    <div class="card-body">
                        <form id="postForm">
                            <div class="my-3">
                                <label for="title" class="form-label fw-semibold">Title</label>
                                <input type="text" class="form-control" id="title" placeholder="Enter post title"
                                    required />
                            </div>
                            <div class="mb-3">
                                <label for="content" class="form-label fw-semibold">Description</label>
                                <textarea class="form-control" id="content" rows="5" maxlength="300"
                                    placeholder="Describe everything about this post here" required></textarea>
                                <div class="form-text text-end"><span id="charCount">0</span>/300</div>
                            </div>
                            <div class="mb-3 d-flex gap-3">
                                <button type="button" class="btn btn-outline-primary btn-sm" title="Edit">
                                    <i class="bi bi-pencil-square"></i> Edit
                                </button>
                                <button type="button" class="btn btn-outline-danger btn-sm" title="Delete">
                                    <i class="bi bi-trash"></i> Delete
                                </button>
                            </div>
                            <div class="d-flex justify-content-end gap-2">
                                <button type="reset" class="btn btn-outline-secondary">Cancel</button>
                                <button type="submit" class="btn btn-primary">Post</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- Bootstrap CDN -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
        crossorigin="anonymous"></script>
    <!-- SupaBase Library -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- JS File -->
<script>
  const supabaseUrl = "https://srsupgbjukxifyfmdcep.supabase.co";
  const supabaseKey =
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNyc3VwZ2JqdWt4aWZ5Zm1kY2VwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE0Mzg3ODUsImV4cCI6MjA2NzAxNDc4NX0.-yMtzbLPOU_R10ysCz1-sDwl2B4dkvWMU7--R5Zy9Wg";
  const client = supabase.createClient(supabaseUrl, supabaseKey);

  document.getElementById("postForm").addEventListener("submit", async (e) => {
    e.preventDefault();

    const title = document.getElementById("title").value.trim();
    const description = document.getElementById("content").value.trim();

    if (!title || !description) {
      alert("Please fill in both title and description.");
      return;
    }

    const {
      data: { user },
      error: userError,
    } = await client.auth.getUser();

    if (userError || !user) {
      alert("You must be logged in to post.");
      return;
    }

    const { data, error } = await client.from("posts").insert([
      {
        user_id: user.id,
        title: title,
        description: description,
      },
    ]);

    if (error) {
      alert("Error posting: " + error.message);
    } else {
      alert("Post created successfully!");
      window.location.href = "blogs.html";
    }
  });
</script>



</body>

</html>